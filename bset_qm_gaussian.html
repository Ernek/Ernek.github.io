
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Sans+Pro:300,400,400i,700" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://ernek.github.io/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="https://ernek.github.io/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="https://ernek.github.io/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://ernek.github.io/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://ernek.github.io/theme/font-awesome/css/solid.css">


    <link href="https://ernek.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Ernesto's Blog Atom">





<meta name="author" content="Ernek" />
<meta name="description" content="How to run an automated job with Gaussian to explore the effect of basis sets and QM method on NMR calculations" />
<meta name="keywords" content="gaussian, kamiak, wsu, misc">

<meta property="og:site_name" content="Ernesto's Blog"/>
<meta property="og:title" content="Exploring different basis sets and QM methods with Gaussian"/>
<meta property="og:description" content="How to run an automated job with Gaussian to explore the effect of basis sets and QM method on NMR calculations"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://ernek.github.io/bset_qm_gaussian.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2023-04-22 12:00:00-07:00"/>
<meta property="article:modified_time" content="2023-04-22 12:00:00-07:00"/>
<meta property="article:author" content="https://ernek.github.io/author/ernek.html">
<meta property="article:section" content="misc"/>
<meta property="article:tag" content="gaussian"/>
<meta property="article:tag" content="kamiak"/>
<meta property="article:tag" content="wsu"/>
<meta property="article:tag" content="misc"/>
<meta property="og:image" content="/images/avatar02.jpg">

  <title>Ernesto's Blog &ndash; Exploring different basis sets and QM methods with Gaussian</title>

</head>
<body>
  <aside>
    <div>
      <a href="https://ernek.github.io">
        <img src="/images/avatar02.jpg" alt="Ernesto's Blog" title="Ernesto's Blog">
      </a>
      <h1><a href="https://ernek.github.io">Ernesto's Blog</a></h1>

<p>Theoretical and Computational Chemistry</p>
      <nav>
        <ul class="list">

          <li><a href="http://python.org/" target="_blank">Python.org</a></li>
        </ul>
      </nav>

      <ul class="social">
          <li>
            <a  class="sc-twitter" href="https://twitter.com/ErnestoCheco" target="_blank">
            <i class="fab fa-twitter">
            </i>
          </a></li>
          <li>
            <a  class="sc-github" href="https://github.com/Ernek" target="_blank">
            <i class="fab fa-github">
            </i>
          </a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="https://ernek.github.io">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>

      <a href="https://ernek.github.io/feeds/all.atom.xml">    Atom
</a>

    </nav>

<article class="single">
  <header>
      
    <h1 id="bset_qm_gaussian">Exploring different basis sets and QM methods with Gaussian</h1>
    <p>
          Posted on Sat 22 April 2023 in <a href="https://ernek.github.io/category/misc.html">misc</a>


    </p>
  </header>


  <div>
    <h2>Exploring different basis sets and QM methods with Gaussian</h2>
<p>Now, let's increase complexity and try to automate the calculation of the magnetic shielding tensor of Al nucleus in aluminate. Let's use the same molecular geometry we used in our previous HF calculation. We will explore 2 different QM methods and investigate how does the Al shielding calculated value change with an increase in the size of the basis sets (let's use pC[X]VZ (X=D,T,Q) basis sets family) used to describe the Al atomic orbitals.</p>
<h3>Generating the Input and Job-submission files</h3>
<p>My strategy to automate this task was to create a python code with the following algorithm in mind:</p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="kr">Read</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">molecular</span><span class="w"> </span><span class="n">geometry</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nb">int</span><span class="n">erest</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="mf">.</span><span class="n">xyz</span><span class="w"> </span><span class="n">file</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kr">input</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="kr">cont</span><span class="n">aining</span><span class="w"> </span><span class="n">said</span><span class="w"> </span><span class="mf">.</span><span class="n">xyz</span><span class="w"> </span><span class="n">coordinates</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">job</span><span class="w"> </span><span class="n">directives</span>
<span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="n">Generating</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nb">sin</span><span class="n">gle</span><span class="w"> </span><span class="kr">input</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="kr">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">QM</span><span class="o">/</span><span class="n">basis</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">combination</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">Gaussian</span><span class="w"> </span><span class="n">submissions</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">previously</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="kr">input</span><span class="w"> </span><span class="n">file</span>
</code></pre></div>

<p>The .xyz file should be on the same folder of our python code (I will get into the python code in a moment) and shold look like this:</p>
<div class="highlight"><pre><span></span><code><span class="m">9</span>

Al<span class="w"> </span><span class="m">4</span>.158934<span class="w"> </span><span class="m">12</span>.319204<span class="w"> </span><span class="m">8</span>.139289<span class="w">   </span>
O<span class="w"> </span><span class="m">5</span>.204656<span class="w"> </span><span class="m">12</span>.33906<span class="w"> </span><span class="m">6</span>.772874
H<span class="w"> </span><span class="m">5</span>.524529<span class="w"> </span><span class="m">11</span>.426276<span class="w"> </span><span class="m">6</span>.453445
O<span class="w"> </span><span class="m">4</span>.893735<span class="w"> </span><span class="m">13</span>.419199<span class="w"> </span><span class="m">9</span>.302062
H<span class="w"> </span><span class="m">5</span>.82317<span class="w"> </span><span class="m">13</span>.510635<span class="w"> </span><span class="m">9</span>.461939
O<span class="w"> </span><span class="m">2</span>.621193<span class="w"> </span><span class="m">13</span>.123312<span class="w"> </span><span class="m">7</span>.624101
H<span class="w"> </span><span class="m">2</span>.124667<span class="w"> </span><span class="m">13</span>.404712<span class="w"> </span><span class="m">8</span>.410292
O<span class="w"> </span><span class="m">3</span>.723529<span class="w"> </span><span class="m">10</span>.689556<span class="w"> </span><span class="m">8</span>.948275
H<span class="w"> </span><span class="m">3</span>.223616<span class="w"> </span><span class="m">10</span>.091097<span class="w"> </span><span class="m">8</span>.387248
</code></pre></div>

<p>We can save it as "al-oh_4_config.xyz". The first line is the number of atoms and the block of data is similar to the format we used in the <strong>input</strong> file above. Leave that empty line between the number of atoms (N) and the start of the coordinates' data (this is the format of .xyz files).</p>
<p>Let's look at our python code by sections. The first snippet of code is just to import modules.</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># coding: utf-8</span>

<span class="c1"># Code to transform an .xyz snap file to Gaussian input exploring several Basis Sets and QM methods</span>

<span class="c1">#%%</span>
<span class="c1"># Importing modules ######################################################################################</span>

<span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">fnmatch</span>              <span class="c1"># To read files</span>
<span class="kn">from</span> <span class="nn">django.utils.text</span> <span class="kn">import</span> <span class="n">slugify</span>   <span class="c1"># To convert special characters to valid file_path names</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">from</span> <span class="nn">unidecode</span> <span class="kn">import</span> <span class="n">unidecode</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">argparse</span>  
</code></pre></div>

<p>We need to use core-valence Dunning basis sets for Al. These basis sets are not included in the default keywords of Gaussian software. We need to explicitly include basis-sets functions' coefficients and exponents for each atom in the input file (i.e we cannot use hf/cc-pCVZ in the input because cc-pCVZ basis sets keyword will not be recognized by Gaussian).   </p>
<p>We make use of a cloned repository of basis sets containing the EMSL Basis-Sets Database (you can find the basis_set_exchange repository <a href="https://github.com/aoterodelaroza/emsl_basis_set_library">here</a> )</p>
<p>Let's define the some functions that will be necessary to create our input files:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="o">%%</span>
<span class="err">#</span><span class="w"> </span><span class="n">Functions</span><span class="w">   </span><span class="err">############################################################################################</span>

<span class="n">def</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="ss">&quot;&quot;&quot;A custom version of slugify that retains non-ascii characters. The purpose of this</span>
<span class="ss">        function in the application is to make folder names readable by command line tools.&quot;&quot;&quot;</span>
<span class="w">        </span><span class="n">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">txt</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="k">trailing</span><span class="w"> </span><span class="n">whitespace</span>
<span class="w">        </span><span class="n">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\*&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-pol&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">txt</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="nf">UNICODE</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nf">replace</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="n">pol</span><span class="o">=</span><span class="n">polarization</span><span class="w"> </span><span class="n">funcitons</span>
<span class="w">        </span><span class="n">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\+&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-dif&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">txt</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="nf">UNICODE</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nf">replace</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nc">text</span><span class="w"> </span><span class="n">dif</span><span class="o">=</span><span class="n">diffuse</span><span class="w"> </span><span class="n">funcitons</span>
<span class="w">        </span><span class="n">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">&#39;\(&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">txt</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="nf">UNICODE</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="nf">replace</span><span class="w"> </span><span class="nf">left</span><span class="w"> </span><span class="n">parenthesis</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">dash</span>
<span class="w">        </span><span class="n">txt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="n">r</span><span class="s1">&#39;[?,:!@#~`=$%^&amp;\)\[\]{}&lt;&gt;]&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">txt</span><span class="p">,</span><span class="w"> </span><span class="n">re</span><span class="p">.</span><span class="nf">UNICODE</span><span class="p">)</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">remove</span><span class="w"> </span><span class="ow">some</span><span class="w"> </span><span class="n">characters</span><span class="w"> </span><span class="n">altogether</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">txt</span>

<span class="n">def</span><span class="w"> </span><span class="n">get_bse_local</span><span class="p">(</span><span class="n">loc_basis</span><span class="p">,</span><span class="w"> </span><span class="k">element</span><span class="p">)</span><span class="err">:</span>
<span class="w">        </span><span class="ss">&quot;&quot;&quot;A function to extract element basis sets data from local EMSL database located</span>
<span class="ss">        in /data/clark/ernesto/bss/emsl_basis_set_library/gbs &quot;&quot;&quot;</span>
<span class="w">        </span><span class="n">addrs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;/data/clark/ernesto/bss/emsl_basis_set_library/gbs/&#39;</span>
<span class="w">        </span><span class="k">with</span><span class="w"> </span><span class="k">open</span><span class="p">(</span><span class="n">addrs</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="n">loc_basis</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.gbs&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nl">fbasis</span><span class="p">:</span>
<span class="w">            </span><span class="n">lines</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fbasis</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="w">            </span><span class="n">bs_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">[]</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">lines</span><span class="p">))</span><span class="err">:</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">lines</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">split</span><span class="p">()</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nf">str</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="k">element</span><span class="err">:</span>
<span class="w">                    </span><span class="n">oidx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span>
<span class="w">                    </span><span class="n">oline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lines</span><span class="o">[</span><span class="n">oidx</span><span class="o">]</span>
<span class="w">                    </span><span class="k">while</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">oline</span><span class="p">.</span><span class="n">split</span><span class="p">()</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;****&#39;</span><span class="err">:</span>
<span class="w">                        </span><span class="n">bs_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">oline</span><span class="p">)</span>
<span class="w">                        </span><span class="n">oidx</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                        </span><span class="n">oline</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lines</span><span class="o">[</span><span class="n">oidx</span><span class="o">]</span>
<span class="w">                </span><span class="k">else</span><span class="err">:</span>
<span class="w">                    </span><span class="k">continue</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">bs_list</span>
</code></pre></div>

<p>The second function contains a variable "addrs" that should be equal to the path where you will save the basis-sets EMSL Database repository (note you will have to clone the repo on Kamiak from <a href="https://github.com/aoterodelaroza/emsl_basis_set_library">here</a>).</p>
<p>Now we can define our Main function. Our code creates folders for each combination of Method and Basis-sets and generates the corresponding input files. Additionally, the code creates the corresponding Gaussian submission scripts ready to be launched on Kamiak cluster with no additional flags.  </p>
<div class="highlight"><pre><span></span><code><span class="c1">#%%</span>

<span class="c1"># Main Function -- Program  #########################################################################</span>

<span class="n">def</span><span class="w"> </span><span class="n">main</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="n">charge</span><span class="p">,</span><span class="w"> </span><span class="n">spin</span><span class="p">,</span><span class="w"> </span><span class="n">key_run_01</span><span class="p">):</span>

<span class="w">    </span><span class="n">key_method_01</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;giao&#39;</span>

<span class="w">    </span><span class="c1">#Create dictionary with QM methods to be used in Gaussian calculation</span>
<span class="w">    </span><span class="n">functionals</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;hf&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;hf&#39;</span><span class="p">],</span>
<span class="w">                   </span><span class="s1">&#39;mp2&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;mp2&#39;</span><span class="p">],</span>
<span class="w">                   </span><span class="s1">&#39;gga&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;pbe&#39;</span><span class="p">,</span><span class="s1">&#39;blyp&#39;</span><span class="p">]</span>
<span class="w">                  </span><span class="p">}</span>
<span class="w">    </span><span class="c1">#Create dictionary with basis sets to explore with each QM method</span>
<span class="w">    </span><span class="n">basis_sets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s1">&#39;core_valence&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[],</span>
<span class="w">          </span><span class="s1">&#39;dunning&#39;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;cc-pVDZ&#39;</span><span class="p">,</span><span class="s1">&#39;cc-pVTZ&#39;</span><span class="p">,</span><span class="s1">&#39;cc-pVQZ&#39;</span><span class="p">]</span>
<span class="w">                 </span><span class="p">}</span>

<span class="w">    </span><span class="n">core_valence_basis</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">([</span><span class="s1">&#39;cc-pCV&#39;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="s1">&#39;DZ&#39;</span><span class="p">,</span><span class="s1">&#39;TZ&#39;</span><span class="p">,</span><span class="s1">&#39;QZ&#39;</span><span class="p">]))</span>
<span class="w">    </span><span class="n">add_val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">core_valence_basis</span><span class="p">:</span>
<span class="w">        </span><span class="n">add_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="w">        </span><span class="n">add_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;aug-&#39;</span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="n">val</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">basis_sets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;core_valence&#39;</span><span class="p">:</span>
<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">add_val</span><span class="p">:</span>
<span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">val</span><span class="p">:</span>
<span class="w">                    </span><span class="n">basis_sets</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="w">                </span><span class="k">else</span><span class="p">:</span>
<span class="w">                    </span><span class="k">continue</span>
<span class="w">        </span><span class="k">else</span><span class="p">:</span>
<span class="w">            </span><span class="k">continue</span>

<span class="w">    </span><span class="n">cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span><span class="w">  </span><span class="c1"># get Current Working Directory</span>

<span class="w">    </span><span class="c1"># Initializing input file reading and outputting file</span>
<span class="w">    </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;r&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>
<span class="w">        </span><span class="n">cnt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[]</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">f</span><span class="p">:</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<span class="w">                </span><span class="n">N</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="w">                </span><span class="n">cnt</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">elif</span><span class="w"> </span><span class="n">cnt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span>
<span class="w">                </span><span class="n">cnt</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="k">else</span><span class="p">:</span>
<span class="w">                </span><span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="w">                </span><span class="n">cnt</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">1</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">fkey</span><span class="p">,</span><span class="n">fval</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">functionals</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">fval</span><span class="p">:</span>
<span class="w">            </span><span class="n">try</span><span class="p">:</span>
<span class="w">                </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;/&#39;</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>
<span class="w">            </span><span class="n">except</span><span class="w"> </span><span class="n">FileExistsError</span><span class="p">:</span>
<span class="w">                </span><span class="k">pass</span>

<span class="w">            </span><span class="k">for</span><span class="w"> </span><span class="n">bkey</span><span class="p">,</span><span class="n">bval</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">basis_sets</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="w">                </span><span class="n">try</span><span class="p">:</span>
<span class="w">                    </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bkey</span><span class="p">)</span>
<span class="w">                </span><span class="n">except</span><span class="w"> </span><span class="n">FileExistsError</span><span class="p">:</span>
<span class="w">                    </span><span class="k">pass</span>
<span class="w">                </span><span class="k">if</span><span class="w">  </span><span class="n">bkey</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;core_valence&#39;</span><span class="p">:</span>
<span class="w">                    </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">bval</span><span class="p">:</span>
<span class="w">                        </span><span class="n">try</span><span class="p">:</span>
<span class="w">                            </span><span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bkey</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
<span class="w">                        </span><span class="n">except</span><span class="w"> </span><span class="n">FileExistsError</span><span class="p">:</span>
<span class="w">                            </span><span class="k">pass</span>

<span class="w">                        </span><span class="n">al_bse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_bse_local</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Al&#39;</span><span class="p">)</span>

<span class="w">                        </span><span class="k">for</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">[</span><span class="n">basis_sets</span><span class="p">[</span><span class="s1">&#39;dunning&#39;</span><span class="p">][</span><span class="n">indx</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">indx</span><span class="p">,</span><span class="n">t</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">enumerate</span><span class="p">(</span><span class="n">basis_sets</span><span class="p">[</span><span class="s1">&#39;dunning&#39;</span><span class="p">])</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;5&#39;</span><span class="p">]:</span>
<span class="w">                            </span><span class="n">out_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.com&#39;</span>
<span class="w">                            </span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">bkey</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
<span class="w">                            </span><span class="n">o_bse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_bse_local</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;O&#39;</span><span class="p">)</span>
<span class="w">                            </span><span class="n">h_bse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_bse_local</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;H&#39;</span><span class="p">)</span>
<span class="w">                            </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">out_fname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">output</span><span class="p">:</span>
<span class="w">                                </span><span class="n">output</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%c</span><span class="s1">hk=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="s2">&quot;#P {key_run_01}={key_method_01} {i}/Gen&quot;</span><span class="w">                              </span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n\n</span><span class="s1">&#39;</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">spin</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="w">                             </span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">))</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">al_bse</span><span class="p">))</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;****</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">o_bse</span><span class="p">))</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;****</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span><span class="n">h_bse</span><span class="p">))</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;****</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                            </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                        </span><span class="p">)</span>

<span class="w">                            </span><span class="n">sub_fname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;sub_g09&#39;</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;.slurm&#39;</span>
<span class="w">                            </span><span class="n">with</span><span class="w"> </span><span class="n">open</span><span class="p">(</span><span class="n">sub_fname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">sub_out</span><span class="p">:</span>
<span class="w">                                </span><span class="n">sub_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;#!/bin/bash&#39;</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="w">                                   </span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;#SBATCH --job-name=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">slugify</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;   ###Job Name&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;#SBATCH --partition=clark,kamiak,cas  ###Partition on which to run&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;#SBATCH --nodes=1           ###Number of nodes to use&#39;</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;#SBATCH --ntasks-per-node=20 ###Number of tasks per node (aka MPI processes)&#39;</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;#SBATCH --cpus-per-task=1   ###Number of cpus per task (aka OpenMP threads)&#39;</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;#SBATCH --time=7-00:00:00&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;module load gaussian&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;finit=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nb">str</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">u_slugify</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span>
<span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;fend=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.com&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;foutend=&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;.out&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;export GAUSS_SCRDIR=&quot;$(mkworkspace -q)&quot; &#39;</span><span class="w"> </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;g09 &lt; ${finit}${fend} &gt; ${finit}${foutend}&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="w">                     </span>
<span class="w">                                              </span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
<span class="w">                                            </span><span class="p">)</span>
<span class="w">                        </span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
<span class="w">                </span><span class="k">else</span><span class="p">:</span>
<span class="w">                    </span><span class="k">continue</span>
<span class="w">    </span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">cwd</span><span class="p">)</span>
</code></pre></div>

<p>and finally the last bit to make our code modular and define some flags to specify for each molecular system. Flags include:</p>
<div class="highlight"><pre><span></span><code><span class="mf">1.</span><span class="w"> </span><span class="n">Name</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mf">.</span><span class="n">xyz</span><span class="w"> </span><span class="n">file</span>
<span class="mf">2.</span><span class="w"> </span><span class="kr">To</span><span class="n">tal</span><span class="w"> </span><span class="n">Charge</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kr">sys</span><span class="n">tem</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">Spin</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="kr">sys</span><span class="n">tem</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">Method</span><span class="p">:</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">HF</span><span class="w"> </span><span class="nb">sin</span><span class="n">gle</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">calculation</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">flag</span><span class="w"> </span><span class="n">present</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="n">NMR</span><span class="w"> </span><span class="n">shielding</span><span class="w"> </span><span class="n">tensor</span><span class="w"> </span><span class="n">calculation</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="kr">if</span><span class="w"> </span><span class="n">option</span><span class="w"> </span><span class="s">&quot;-m nmr&quot;</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">included</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="o">%%</span><span class="w">    </span>

<span class="k">if</span><span class="w"> </span><span class="nx">__name__</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">__main__</span><span class="err">&#39;</span><span class="p">:</span>
<span class="w">    </span><span class="nx">parser</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">argparse</span><span class="p">.</span><span class="nx">ArgumentParser</span><span class="p">()</span>
<span class="w">    </span><span class="nx">parser</span><span class="p">.</span><span class="nx">add_argument</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">filename</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">help</span><span class="p">=</span><span class="err">&#39;</span><span class="nx">Enter</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">xyz</span><span class="w"> </span><span class="nx">filename</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">.</span><span class="nx">e</span><span class="w"> </span><span class="s">&quot;aloh4.xyz&quot;</span><span class="w"> </span><span class="err">&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">parser</span><span class="p">.</span><span class="nx">add_argument</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">charge</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">help</span><span class="p">=</span><span class="err">&#39;</span><span class="nx">Enter</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">system</span><span class="w"> </span><span class="nx">total</span><span class="w"> </span><span class="nx">charge</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">.</span><span class="nx">e</span><span class="w"> </span><span class="s">&quot;-1&quot;</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="p">=</span><span class="nx">int</span><span class="p">)</span>
<span class="w">    </span><span class="nx">parser</span><span class="p">.</span><span class="nx">add_argument</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">spin</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">help</span><span class="p">=</span><span class="err">&#39;</span><span class="nx">Enter</span><span class="w"> </span><span class="nx">spin</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">whole</span><span class="w"> </span><span class="nx">system</span><span class="w"> </span><span class="nx">i</span><span class="p">.</span><span class="nx">e</span><span class="w"> </span><span class="s">&quot;1&quot;</span><span class="w"> </span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="p">=</span><span class="nx">int</span><span class="p">)</span>
<span class="w">    </span><span class="nx">parser</span><span class="p">.</span><span class="nx">add_argument</span><span class="p">(</span><span class="s">&quot;-m&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;--method&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">help</span><span class="p">=</span><span class="err">&#39;</span><span class="nx">Enter</span><span class="w"> </span><span class="nx">job</span><span class="w"> </span><span class="nx">directive</span><span class="p">,</span><span class="w"> </span><span class="nx">i</span><span class="p">.</span><span class="nx">e</span><span class="w"> </span><span class="s">&quot;nmr&quot;</span><span class="p">;</span><span class="err">&#39;</span><span class="w"> </span>\
<span class="w">                        </span><span class="o">+</span><span class="err">&#39;</span><span class="k">if</span><span class="w"> </span><span class="nx">no</span><span class="w"> </span><span class="nx">arg</span><span class="w"> </span><span class="nx">passed</span><span class="w"> </span><span class="nx">defaults</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">single</span><span class="w"> </span><span class="nx">point</span><span class="w"> </span><span class="nx">energy</span><span class="w"> </span><span class="nx">calc</span><span class="err">&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="p">=</span><span class="nx">str</span><span class="p">,</span><span class="w"> </span><span class="nx">choices</span><span class="p">=[</span><span class="err">&#39;</span><span class="nx">nmr</span><span class="err">&#39;</span><span class="p">])</span>
<span class="w">    </span><span class="nx">args</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">parser</span><span class="p">.</span><span class="nx">parse_args</span><span class="p">()</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">method</span><span class="p">:</span>
<span class="w">        </span><span class="nx">print</span><span class="p">(</span><span class="nx">f</span><span class="s">&quot;Method selected is: {args.method}&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="k">else</span><span class="p">:</span>
<span class="w">        </span><span class="nx">print</span><span class="p">(</span><span class="s">&quot;Default method. Generating input with single point energy calculation&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">main</span><span class="p">(</span><span class="nx">args</span><span class="p">.</span><span class="nx">filename</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">charge</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">spin</span><span class="p">,</span><span class="w"> </span><span class="nx">args</span><span class="p">.</span><span class="nx">method</span><span class="p">)</span>
</code></pre></div>

<p>After running this code you can launch the jobs using the generated submission scripts.
Remember to create an environment on Kamiak to install necessary python modules</p>
<div class="highlight"><pre><span></span><code>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>env_name
conda<span class="w"> </span>activate<span class="w"> </span>env_name
conda<span class="w"> </span>install<span class="w"> </span>pandas
conda<span class="w"> </span>install<span class="w"> </span>django
.
.
</code></pre></div>

<p>This code runs with the latests versions of python 3 since it uses "formatted string literals" (f-string methods).
You can find this python code in one piece in one of my Github repositories: <a href="https://github.com/Ernek/NMR/tree/master/nmr-run">https://github.com/Ernek/NMR/tree/master/nmr-run</a> . In its current version it explores HF, MP2, BLYP and PBE methods and uses a combination of Al core-valence basis sets (aug-/cc-pC[D,T,]VZ) combined with cc-pV[D,T,Q]Z for oxygen [O] and hydrogen [H] atoms. </p>
<p>Details about the code functionality are limited to most fundamental aspects. Test your outputs at your own discretion.</p>
<p>Have fun!</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://ernek.github.io/tag/gaussian.html">gaussian</a>
      <a href="https://ernek.github.io/tag/kamiak.html">kamiak</a>
      <a href="https://ernek.github.io/tag/wsu.html">wsu</a>
      <a href="https://ernek.github.io/tag/misc.html">misc</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Ernesto's Blog ",
  "url" : "https://ernek.github.io",
  "image": "/images/avatar02.jpg",
  "description": "A place to save my learning journey"
}
</script>

</body>
</html>